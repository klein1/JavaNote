## volatile

JVM中存在一个**主内存**(Java Heap Memory)，Java中所有变量都储存在主存中，对于所有线程都是共享的；

每个线程都有自己的**工作内存**(Working Memory)，工作内存中保存的是主存中某些变量的拷贝，线程对所有变量的操作都是在工作内存中进行，线程之间无法相互直接访问，变量传递均需要通过主存完成。

![image.png](https://upload-images.jianshu.io/upload_images/9229344-d124fdcf32117b0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![image.png](https://upload-images.jianshu.io/upload_images/9229344-6ab9325b1675ecdb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



### static和volatile的区别

1. volatile是告诉编译器，**每次取这个变量的值都需要从主存中取，而不是用自己线程工作内存中的缓存**；
2. static是说这个变量，在主存中所有此类的实例用的是同一份，各个线程创建时需要从主存同一个位置拷贝到自己工作内存中去(而不是拷贝此类不同实例中的这个变量的值)，也就是说只能保证线程创建时，变量的值是相同来源的，运行时还是使用各自工作内存中的值,依然会有不同步的问题。



